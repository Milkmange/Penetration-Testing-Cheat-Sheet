# IPv6 DNS Takeover to Domain Admin using mitm6 and ntlmrelayx

## Background

Microsoft Windows hosts will default to resolving all DNS lookups over IPv6, if an IPv6 DNS server broadcasts and is known on the network. The tool mitm6 can be used to create a rogue IPv6 DNS server that will assume the role of answering DNS requests within the active directory network. Once DNS requests are man-in-the-middled, ntlmrelayx can be used to relay authentication requests to a domain controller over LDAPS and carry out two objectives. The first is that all user accounts, groups, trusts and domain information will be dumped into HTML and json files for parsing. If a DNS request for an administrator is intercepted, a new admin user will be created with rights that will allow a dcsync attack to be conducted against the domain controller.

## Steps to carry out the attack

For this attack to work, you will need to be situated on an internal network segment of the active directory domain with a Linux distribution such as Kali Linux.
